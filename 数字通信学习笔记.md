# 数字通信学习笔记

## 需要解决的问题有：

1. QPSK通信仿真

2. 数字锁相环设计

------------------


+ 问题1：QPSK通信仿真。

**数字通信是用数字信号做为载体来传输信息，或用数字信号对载波进行数字调制后再传输的通信方式。它可传输电报、数字数据等数字信号，也可以传输经过数字化处理的语音和图像信号。**

**QPSK（Quadrature Phase Shift Keying）：正交相移键控。四相相移调制是利用载波的四种不同相位差来表征输入的数字信息。QPSK是一种四进制相位调制，具有良好的抗噪特性和频带利用率。在QPSK调制中，QPSK信号可以看作两个载波正交的2PSK调制器构成。输入信号经过串并转换器后，该二进制序列分为速率减半的两个并行的双极性序列，然后分别经过两个正交的** *sin wt* **和** *cos wt* **进行调制，再将两个信号相加可得QPSK信号。 其基本结构如下图所示。**

  ![QPSK调制](https://s1.ax1x.com/2020/07/21/UISFOg.png)
  
  > 调制的概念：在无线电通信系统中，为实现电信号的传输，需要将待传送信号的频谱搬移到较高的频率范围，这种频谱的搬移成为信号调制。
  
  
  **QPSK映射关系：**
  
  
  | 编码 | 映射关系 | 相位 |
  |:----:|:-------:|:-----:|
  |  00  |  (1,1)  |  π/4  |
  |  01  |  (-1,1) |  3π/4 |
  |  11  | (-1,-1) |  5π/4 |
  |  10  |  (1,-1) |  7π/4 |

-------------------

### 完成QPSK调制的基本思路如下：

**一、产生信号与调制**

*首先设定基本参数为：fs = 8; fd = 1; N = 64;*
  
**（1）. 利用randi()函数生成随机序列**
  
 *x = randi([0,1],1,N);* 
  
**（2）. 映射准备以及利用genqammod()函数进行映射**

  *const = [1+1i,-1+1i,1-1i,-1-1i];*
  
  *x = genqammod(x,const);*
  
 **（3）取出实部虚部，即为QPSK的同相分量和正交分量**
 
 **（4）利用scatterplot()函数绘制QPSK的星座图**
 
 **二、插值**
 
 **插值的目的主要是为了增加其抽样频率。**
 
  **利用upsample()函数对调制后的信号进行上采样，也即内插值。**
  
  *y = upsample(x,8); %在每个值之间插入(8-1)个0*
  
 **三、低通滤波**
 
 **采用MATLAB中rcosin()函数来实现升余弦滤波器**
 
 >滚降系数：在无码间串扰条件下所需带宽 W 和码元传输速率 Rs 的比值。

  >1、当α＝0时，就是理想奈奎斯特滤波器，此时的传输带宽是理想奈奎斯特滤波器的最小带宽，但当 α>0 时，系统传输带宽就超过了奈奎斯特最小带宽，这时码率速率 Rs 就小于小于 2 倍带宽，如果解调器在每个码元间隔内仅做一次采样，那么会因为采样点太少而不能可靠恢复模拟波形，产生失真。

  >2、但是数字通信系统不需要恢复模拟波形，只需要在取样时刻无码间串扰就行，而升余弦系列滤波器在取样时刻具有无码间串扰特性。因此，仍符合奈奎斯特第一准则，它所实现的频谱效率要比理论最高效率下降一个滚降系数а 倍。
  >3、滚降系数а影响着频谱效率，а越小，频谱效率就越高，但а过小时，升余弦滚降滤波器的设计和实现比较困难，而且当传输过程中发生线性失真时产生的符号间干扰也比较严重。在实际工程中，а的范围一般定在 0.15～0.5 之间
 
 **其中rcosine(Fd, Fs, TYPE_FLAG, R, DELAY)的各参数含义如下：**
  
   *Fd为基带频率*
 
   *Fs为抽样频率*
 
   *type_flag为滤波器的类型*
   
   *R为滚降系数*
 
   *delay为时延系数，必须为正整数*
   
 **本次实验中使用rcosine(fd,fs,'fir/sqrt',0.25,1)；代表生成一个“均方升余弦FIR型滤波器，其中滚降系数为0.25，延时为1” 。**

 **再将前述信号与该滤波器进行卷积即可实现低频部分通过的功能。取出信号的实部即为滤波后的同向分量，虚部即为滤波后的正交分量。**
 
 **四、加入awgn噪声**
 
 在MATLAB中，***awgn()*** 函数是将一定信噪比的高斯白噪声添加到理论信号中，产生添加噪声后的模拟信号。另一个函数***wgn()*** 仅是产生高斯白噪声。
 
 **y = awgn(y, 100)意为给信号y加入信噪比为100dB的高斯白噪声。**
 
 **五、匹配滤波器**
 
 > 匹配滤波器是指，输出端的信号瞬时功率与噪声平均功率的比值最大的线性滤波器也就是说有最大信噪比的滤波器。其滤波器的传递函数形式是信号频谱的共轭。
 
 **匹配滤波器的时域冲激响应表达式为：h(t)=KS共轭(t0-t) 频域表达式为：H(w)=KS共轭(w)e^jwt**
 
 *在此次的MATLAB程序中，该程序员写的是：*
 
 *y = conv(y,filter);*
 
 *并没有达到匹配滤波器的效果，仅仅只是对加入噪声后的信号进行了一次低通滤波。这里不是很明白他为什么要这样操作。*
 
 **六、采样**
 
 >采样也称抽样，是信号在时间上的离散化，即按照一定时间间隔△t 在模拟信号x(t)上逐点采取其瞬时值。它是通过采样脉冲和模拟信号相乘来实现的。
 
 **去除前后16个由卷积造成的冗余点后绘制星座图** *（为什么是16个？）*
 
 **七、解调**

 **根据前面设定的映射关系进行解调。**
 
 **主要思路为：**

    1.若抽样值虚部大于等于0，则其奇数位为0；否则其奇数位为1。
    
    2.若抽样值实部大于等于0，则其偶数位为0；否则其偶数位为1。
    
 **八、将原信号与解调后的信号对比，观察是否有误码，若无，则通信成功**
 
 
